<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>07-MySQLHAï¼šå¦‚ä½•å°†â€œåˆ åº“è·‘è·¯â€çš„æŸå¤±é™åˆ°æœ€ä½ï¼Ÿ</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>07-MySQLHAï¼šå¦‚ä½•å°†â€œåˆ åº“è·‘è·¯â€çš„æŸå¤±é™åˆ°æœ€ä½ï¼Ÿ</h1>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æç¥ã€‚</p><p>å¯¹äºä»»ä½•ä¸€ä¸ªä¼ä¸šæ¥è¯´ï¼Œæ•°æ®å®‰å…¨çš„é‡è¦æ€§æ˜¯ä¸è¨€è€Œå–»çš„ã€‚æˆ‘åœ¨å¼€ç¯‡è¯ä¸­ä¹Ÿæ›¾ç»å¼ºè°ƒè¿‡ï¼Œå‡¡æ˜¯æ¶‰åŠåˆ°æ•°æ®çš„é—®é¢˜ï¼Œéƒ½æ˜¯æŸå¤±æƒ¨é‡çš„å¤§é—®é¢˜ã€‚</p><p>èƒ½å¤Ÿå½±å“æ•°æ®å®‰å…¨çš„äº‹ä»¶ï¼Œéƒ½æ˜¯æå°æ¦‚ç‡çš„äº‹ä»¶ï¼Œæ¯”å¦‚è¯´ï¼šæ•°æ®åº“å®•æœºã€ç£ç›˜æŸåç”šè‡³æœºæˆ¿ç€ç«ï¼Œè¿˜æœ‰æœ€è¿‘é¢‘ç¹å‡ºç°åœ¨æ®µå­ä¸­â€œç¨‹åºå‘˜ä¸æ»¡è€æ¿åˆ åº“è·‘è·¯â€çš„æ¢—å„¿ï¼Œä½†è¿™äº›äº‹å„¿ä¸€æ—¦å‘ç”Ÿäº†ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡å°±ä¼šæŸå¤±æƒ¨é‡ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå­˜å‚¨ç³»ç»Ÿå¯¼è‡´çš„æ¯”è¾ƒä¸¥é‡çš„æŸå¤±ä¸»è¦æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€æ˜¯æ•°æ®ä¸¢å¤±é€ æˆçš„ç›´æ¥è´¢äº§æŸå¤±ï¼Œæ¯”å¦‚å¤§é‡çš„åè´¦ï¼›äºŒæ˜¯ç”±äºå­˜å‚¨ç³»ç»ŸæŸåï¼Œé€ æˆæ•´ä¸ªä¸šåŠ¡ç³»ç»Ÿåœæ­¢æœåŠ¡è€Œå¸¦æ¥çš„æŸå¤±ã€‚</p><p>æ‰€è°“é˜²æ‚£äºæœªç„¶ï¼Œä½ ä»è®¾è®¡ä¸€ä¸ªç³»ç»Ÿçš„ç¬¬ä¸€å¤©èµ·ï¼Œå°±éœ€è¦è€ƒè™‘åœ¨å‡ºç°å„ç§é—®é¢˜çš„æ—¶å€™ï¼Œå¦‚ä½•æ¥ä¿è¯è¿™ä¸ªç³»ç»Ÿçš„æ•°æ®å®‰å…¨æ€§ã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠä¸€èŠï¼Œå¦‚ä½•æå‰é¢„é˜²ï¼Œå°†â€œåˆ åº“è·‘è·¯â€ç­‰è¿™ç±»é—®é¢˜å¯¼è‡´çš„æŸå¤±å°½é‡é™åˆ°æœ€ä½ã€‚</p><h2>å¦‚ä½•æ›´å®‰å…¨åœ°åšæ•°æ®å¤‡ä»½å’Œæ¢å¤ï¼Ÿ</h2><p>ä¿è¯æ•°æ®å®‰å…¨ï¼Œæœ€ç®€å•è€Œä¸”æœ‰æ•ˆçš„æ‰‹æ®µå°±æ˜¯å®šæœŸå¤‡ä»½æ•°æ®ï¼Œè¿™æ ·å‡ºç°ä»»ä½•é—®é¢˜å¯¼è‡´çš„æ•°æ®æŸå¤±ï¼Œéƒ½å¯ä»¥é€šè¿‡å¤‡ä»½æ¥æ¢å¤æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¦‚ä½•å¤‡ä»½ï¼Œæ‰èƒ½æœ€å¤§ç¨‹åº¦åœ°ä¿è¯æ•°æ®å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªç®€å•çš„äº‹å„¿ã€‚</p><p>2018å¹´è¿˜å‡ºç°è¿‡æŸä¸ªè‘—åçš„äº‘æœåŠ¡å•†å› ä¸ºç¡¬ç›˜æŸåï¼Œå¯¼è‡´å¤šä¸ªå®¢æˆ·æ•°æ®å…¨éƒ¨ä¸¢å¤±çš„é‡å¤§æ•…éšœã€‚è¿™ä¹ˆå¤§çš„äº‘æœåŠ¡å•†ï¼Œæ•°æ®æ˜¯ä¸å¯èƒ½æ²¡æœ‰å¤‡ä»½çš„ï¼ŒæŒ‰è¯´ç¡¬ç›˜æŸåï¼Œä¸ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±çš„ï¼Œä½†æ˜¯å› ä¸ºå„ç§å„æ ·çš„åŸå› ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯æ•°æ®çš„ä¸‰ä¸ªå‰¯æœ¬éƒ½è¢«åˆ é™¤ï¼Œæ•°æ®ä¸¢å¤±æ— æ³•æ‰¾å›ã€‚</p><!-- [[[read_end]]] --><p>æ‰€ä»¥è¯´ï¼Œä¸æ˜¯ç®€å•åœ°å®šæœŸæŠŠæ•°æ®å¤‡ä»½ä¸€ä¸‹å°±å¯ä»¥é«˜æ•æ— å¿§äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜æ˜¯ä»¥å¤§å®¶æœ€å¸¸ç”¨çš„MySQLä¸ºä¾‹æ¥è¯´ä¸€ä¸‹ï¼Œå¦‚ä½•æ›´å®‰å…¨åœ°æ¥åšæ•°æ®å¤‡ä»½å’Œæ¢å¤ã€‚</p><p>æœ€ç®€å•çš„å¤‡ä»½æ–¹å¼å°±æ˜¯å…¨é‡å¤‡ä»½ã€‚å¤‡ä»½çš„æ—¶å€™ï¼ŒæŠŠæ‰€æœ‰çš„æ•°æ®å¤åˆ¶ä¸€ä»½ï¼Œå­˜æ”¾åˆ°æ–‡ä»¶ä¸­ï¼Œæ¢å¤çš„æ—¶å€™å†æŠŠæ–‡ä»¶ä¸­çš„æ•°æ®å¤åˆ¶å›å»ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¢å¤ä¹‹åæ•°æ®åº“ä¸­çš„æ•°æ®å’Œå¤‡ä»½æ—¶æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚åœ¨MySQLä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<a href="https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html">mysqldump</a>å‘½ä»¤æ¥æ‰§è¡Œå…¨é‡å¤‡ä»½ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬è¦å…¨é‡å¤‡ä»½æ•°æ®åº“testï¼š</p><pre><code>$mysqldump -uroot -p test &gt; test.sql
</code></pre><p>å¤‡ä»½å‡ºæ¥çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªSQLæ–‡ä»¶ï¼Œå°±æ˜¯åˆ›å»ºæ•°æ®åº“ã€è¡¨ï¼Œå†™å…¥æ•°æ®ç­‰ç­‰è¿™äº›SQLï¼Œå¦‚æœè¦æ¢å¤æ•°æ®ï¼Œç›´æ¥æ‰§è¡Œè¿™ä¸ªå¤‡ä»½çš„SQLæ–‡ä»¶å°±å¯ä»¥äº†ï¼š</p><pre><code>$mysql -uroot test &lt; test.sql
</code></pre><p>ä¸è¿‡ï¼Œå…¨é‡å¤‡ä»½çš„ä»£ä»·éå¸¸é«˜ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œå¤‡ä»½æ–‡ä»¶åŒ…å«æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œå ç”¨çš„ç£ç›˜ç©ºé—´éå¸¸å¤§ï¼›å…¶æ¬¡ï¼Œæ¯æ¬¡å¤‡ä»½æ“ä½œéƒ½è¦æ‹·è´å¤§é‡æ•°æ®ï¼Œå¤‡ä»½è¿‡ç¨‹ä¸­ä¼šå ç”¨æ•°æ®åº“æœåŠ¡å™¨å¤§é‡çš„CPUã€ç£ç›˜IOèµ„æºï¼Œå¹¶ä¸”ä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œè¿˜æœ‰å¯èƒ½ä¼šé”è¡¨ï¼Œè¿™äº›éƒ½ä¼šå¯¼è‡´å¤‡ä»½æœŸé—´ï¼Œæ•°æ®åº“æœ¬èº«çš„æ€§èƒ½ä¸¥é‡ä¸‹é™ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½ç»å¸¸å¯¹æ•°æ®åº“æ‰§è¡Œå…¨é‡å¤‡ä»½ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ¯å¤©æ‰§è¡Œä¸€æ¬¡å…¨é‡å¤‡ä»½å·²ç»æ˜¯éå¸¸é¢‘ç¹äº†ã€‚é‚£è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœæ•°æ®åº“ä¸­çš„æ•°æ®ä¸¢äº†ï¼Œé‚£åªèƒ½æ¢å¤åˆ°æœ€è¿‘ä¸€æ¬¡å…¨é‡å¤‡ä»½çš„é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œè¿™ä¸ªæ—¶é—´ç‚¹ä¹‹åçš„æ•°æ®è¿˜æ˜¯ä¸¢äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¨é‡å¤‡ä»½ä¸èƒ½åšåˆ°å®Œå…¨æ— æŸåœ°æ¢å¤ã€‚</p><p>æ—¢ç„¶å…¨é‡å¤‡ä»½ä»£ä»·å¤ªé«˜ï¼Œä¸èƒ½é¢‘ç¹æ‰§è¡Œï¼Œé‚£æœ‰æ²¡æœ‰ä»£ä»·ä½ä¸€ç‚¹å„¿çš„å¤‡ä»½æ–¹æ³•ï¼Œèƒ½è®©æˆ‘ä»¬å°‘ä¸¢ç”šè‡³ä¸ä¸¢æ•°æ®å‘¢ï¼Ÿè¿˜çœŸæœ‰ï¼Œé‚£å°±æ˜¯<strong>å¢é‡å¤‡ä»½</strong>ã€‚ç›¸æ¯”äºå…¨é‡å¤‡ä»½ï¼Œå¢é‡å¤‡ä»½æ¯æ¬¡åªå¤‡ä»½ç›¸å¯¹äºä¸Šä¸€æ¬¡å¤‡ä»½å˜åŒ–çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œæ‰€ä»¥æ¯æ¬¡å¢é‡å¤‡ä»½é€Ÿåº¦æ›´å¿«ã€‚</p><p>MySQLè‡ªå¸¦äº†Binlogï¼Œå°±æ˜¯ä¸€ç§å®æ—¶çš„å¢é‡å¤‡ä»½ã€‚Binlogé‡Œé¢è®°å½•çš„å°±æ˜¯MySQLæ•°æ®çš„å˜æ›´çš„æ“ä½œæ—¥å¿—ï¼Œå¼€å¯Binlogä¹‹åï¼Œæˆ‘ä»¬å¯¹MySQLä¸­çš„æ¯æ¬¡æ›´æ–°æ•°æ®æ“ä½œï¼Œéƒ½ä¼šè¢«è®°å½•åˆ°Binlogä¸­ã€‚</p><p>Binlogæ˜¯å¯ä»¥å›æ”¾çš„ï¼Œå›æ”¾Binlogï¼Œå°±ç›¸å½“äºæŠŠä¹‹å‰å¯¹æ•°æ®åº“æ‰€æœ‰æ•°æ®æ›´æ–°æ“ä½œæŒ‰ç…§é¡ºåºé‡æ–°æ‰§è¡Œäº†ä¸€éï¼Œå›æ”¾å®Œæˆä¹‹åæ•°æ®è‡ªç„¶å°±æ¢å¤äº†ã€‚è¿™å°±æ˜¯Binlogå¢é‡å¤‡ä»½çš„åŸºæœ¬åŸç†ã€‚å¾ˆå¤šæ•°æ®åº“éƒ½æœ‰ç±»ä¼¼äºMySQL Binlogçš„æ—¥å¿—ï¼ŒåŸç†å’ŒBinlogæ˜¯ä¸€æ ·çš„ï¼Œå¤‡ä»½å’Œæ¢å¤æ–¹æ³•ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚</p><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨Binlogè¿›è¡Œå¤‡ä»½å’Œæ¢å¤ã€‚é¦–å…ˆä½¿ç”¨â€œshow variables like â€˜%log_bin%â€™â€å‘½ä»¤ç¡®è®¤ä¸€ä¸‹æ˜¯å¦å¼€å¯äº†BinlogåŠŸèƒ½ï¼š</p><pre><code>mysql&gt; show variables like '%log_bin%';
+---------------------------------+-----------------------------------+
| Variable_name                   | Value                             |
+---------------------------------+-----------------------------------+
| log_bin                         | ON                                |
| log_bin_basename                | /usr/local/var/mysql/binlog       |
+---------------------------------+-----------------------------------+
mysql&gt; show master status;
+---------------+----------+--------------+------------------+-------------------+
| File          | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |
+---------------+----------+--------------+------------------+-------------------+
| binlog.000001 |    18745 |              |                  |                   |
+---------------+----------+--------------+------------------+-------------------+
</code></pre><p>å¯ä»¥çœ‹åˆ°å½“å‰è¿™ä¸ªæ•°æ®åº“å·²ç»å¼€å¯äº†Binlogï¼Œlog_bin_basenameè¡¨ç¤ºBinlogæ–‡ä»¶åœ¨æœåŠ¡å™¨ç£ç›˜ä¸Šçš„å…·ä½“ä½ç½®ã€‚ç„¶åç”¨â€œshow master statusâ€å‘½ä»¤å¯æŸ¥çœ‹å½“å‰Binlogçš„çŠ¶æ€ï¼Œæ˜¾ç¤ºæ­£åœ¨å†™å…¥çš„Binlogæ–‡ä»¶ï¼ŒåŠå½“å‰çš„ä½ç½®ã€‚å‡è®¾æˆ‘ä»¬æ¯å¤©å‡Œæ™¨ç”¨mysqldumpåšä¸€ä¸ªå…¨é‡å¤‡ä»½ï¼Œç„¶åå¼€å¯äº†Binlogï¼Œæœ‰äº†è¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ•°æ®æ¢å¤åˆ°å…¨é‡å¤‡ä»½ä¹‹åçš„ä»»ä½•ä¸€ä¸ªæ—¶åˆ»ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„å¤‡ä»½æ¢å¤æ¼”ç¤ºã€‚æˆ‘ä»¬å…ˆæ¨¡æ‹Ÿä¸€æ¬¡â€œåˆ åº“è·‘è·¯â€çš„åœºæ™¯ï¼Œç›´æ¥æŠŠè´¦æˆ·ä½™é¢è¡¨æ¸…ç©ºï¼š</p><pre><code>mysql&gt; truncate table account_balance;
Query OK, 0 rows affected (0.02 sec)


mysql&gt; select * from  account_balance;
Empty set (0.00 sec)
</code></pre><p>ç„¶åæˆ‘ä»¬æ¥è¿›è¡Œæ•°æ®æ¢å¤ï¼Œé¦–å…ˆæ‰§è¡Œä¸€æ¬¡å…¨é‡æ¢å¤ï¼ŒæŠŠæ•°æ®åº“æ¢å¤åˆ°ä»Šå¤©å‡Œæ™¨çš„çŠ¶æ€ã€‚</p><pre><code>$mysql -uroot test &lt; dump.sql


mysql&gt; select * from  account_balance;
+---------+---------+---------------------+--------+
| user_id | balance | timestamp           | log_id |
+---------+---------+---------------------+--------+
|       0 |     100 | 2020-02-13 20:24:33 |      3 |
+---------+---------+---------------------+--------+
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¡¨é‡Œé¢çš„æ•°æ®å·²ç»æ¢å¤äº†ï¼Œä½†è¿˜æ˜¯æ¯”è¾ƒæ—§çš„æ•°æ®ã€‚ç„¶åæˆ‘ä»¬å†ç”¨BinlogæŠŠæ•°æ®æ¢å¤åˆ°åˆ åº“è·‘è·¯ä¹‹å‰çš„é‚£ä¸ªæ—¶åˆ»ï¼š</p><pre><code>$mysqlbinlog --start-datetime &quot;2020-02-20 00:00:00&quot; --stop-datetime &quot;2020-02-20 15:09:00&quot; /usr/local/var/mysql/binlog.000001 | mysql -uroot


mysql&gt; select * from  account_balance;
+---------+---------+---------------------+--------+
| user_id | balance | timestamp           | log_id |
+---------+---------+---------------------+--------+
|       0 |     200 | 2020-02-20 15:08:12 |      0 |
+---------+---------+---------------------+--------+
</code></pre><p>è¿™æ—¶å€™ï¼Œæ•°æ®å·²ç»æ¢å¤åˆ°å½“å¤©çš„15ç‚¹äº†ã€‚</p><p>é€šè¿‡å®šæœŸçš„å…¨é‡å¤‡ä»½ï¼Œé…åˆBinlogï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ•°æ®æ¢å¤åˆ°ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œå†ä¹Ÿä¸æ€•ç¨‹åºå‘˜åˆ åº“è·‘è·¯äº†ã€‚è¯¦ç»†çš„å‘½ä»¤ä½ å¯ä»¥å‚è€ƒ<a href="https://dev.mysql.com/doc/refman/8.0/en/backup-and-recovery.html">MySQLçš„å®˜æ–¹æ–‡æ¡£ä¸­â€œå¤‡ä»½å’Œæ¢å¤â€è¿™ä¸€ç« </a>ã€‚</p><p>åœ¨æ‰§è¡Œå¤‡ä»½å’Œæ¢å¤çš„æ—¶å€™ï¼Œæœ‰å‡ ä¸ªè¦ç‚¹ä½ éœ€è¦ç‰¹åˆ«çš„æ³¨æ„ã€‚</p><p><strong>ç¬¬ä¸€ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œâ€œä¸è¦æŠŠæ‰€æœ‰çš„é¸¡è›‹æ”¾åœ¨åŒä¸€ä¸ªç¯®å­ä¸­â€ï¼Œæ— è®ºæ˜¯å…¨é‡å¤‡ä»½è¿˜æ˜¯Binlogï¼Œéƒ½ä¸è¦å’Œæ•°æ®åº“å­˜æ”¾åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Š</strong><strong>ã€‚</strong>æœ€å¥½èƒ½åšåˆ°ä¸åŒæœºæˆ¿ï¼Œç”šè‡³ä¸åŒåŸå¸‚ï¼Œç¦»å¾—è¶Šè¿œè¶Šå¥½ã€‚è¿™æ ·å³ä½¿å‡ºç°æœºæˆ¿ç€ç«ã€å…‰ç¼†è¢«æŒ–æ–­ç”šè‡³åœ°éœ‡ä¹Ÿä¸æ€•ã€‚</p><p><strong>ç¬¬äºŒï¼Œåœ¨å›æ”¾Binlogçš„æ—¶å€™ï¼ŒæŒ‡å®šçš„èµ·å§‹æ—¶é—´å¯ä»¥æ¯”å…¨é‡å¤‡ä»½çš„æ—¶é—´ç¨å¾®æå‰ä¸€ç‚¹å„¿ï¼Œç¡®ä¿å…¨é‡å¤‡ä»½ä¹‹åçš„æ‰€æœ‰æ“ä½œéƒ½åœ¨æ¢å¤çš„BinlogèŒƒå›´å†…ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¢å¤çš„æ•°æ®çš„å®Œæ•´æ€§ã€‚</strong></p><p>å› ä¸ºå›æ”¾Binlogçš„æ“ä½œæ˜¯å…·å¤‡å¹‚ç­‰æ€§çš„ï¼ˆä¸ºäº†ç¡®ä¿å›æ”¾å¹‚ç­‰ï¼Œéœ€è¦è®¾ç½®Binlogçš„æ ¼å¼ä¸ºROWæ ¼å¼)ï¼Œå…³äºå¹‚ç­‰æ€§ï¼Œæˆ‘ä»¬åœ¨ã€Š<a href="https://time.geekbang.org/column/article/204673">01 | åˆ›å»ºå’Œæ›´æ–°è®¢å•æ—¶ï¼Œå¦‚ä½•ä¿è¯æ•°æ®å‡†ç¡®æ— è¯¯ï¼Ÿ</a>ã€‹è¿™èŠ‚è¯¾ä¸­è®²åˆ°è¿‡ï¼Œå¤šæ¬¡æ“ä½œå’Œä¸€æ¬¡æ“ä½œå¯¹ç³»ç»Ÿçš„å½±å“æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥é‡å¤å›æ”¾çš„é‚£éƒ¨åˆ†Binlogå¹¶ä¸ä¼šå½±å“æ•°æ®çš„å‡†ç¡®æ€§ã€‚</p><h2>é…ç½®MySQL HAå®ç°é«˜å¯ç”¨</h2><p>é€šè¿‡å…¨é‡å¤‡ä»½åŠ ä¸ŠBinlogï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®åº“æ¢å¤åˆ°ä»»ä½•ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œè¿™æ ·è‡³å°‘ä¸ä¼šä¸¢æ•°æ®äº†ã€‚å¦‚æœè¯´ï¼Œæ•°æ®åº“æœåŠ¡å™¨å®•æœºäº†ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å¤‡ä»½æ•°æ®ï¼Œå®Œå…¨å¯ä»¥å¯åŠ¨ä¸€ä¸ªæ–°çš„æ•°æ®åº“æœåŠ¡å™¨ï¼ŒæŠŠå¤‡ä»½æ•°æ®æ¢å¤åˆ°æ–°çš„æ•°æ®åº“ä¸Šï¼Œè¿™æ ·æ–°çš„æ•°æ®åº“å°±å¯ä»¥æ›¿ä»£å®•æœºçš„æ•°æ®åº“ï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸ªæ¢å¤æ•°æ®çš„æ—¶é—´æ˜¯å¾ˆé•¿çš„ï¼Œå¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§çš„è¯ï¼Œæœ‰å¯èƒ½éœ€è¦æ¢å¤å‡ ä¸ªå°æ—¶ã€‚è¿™å‡ ä¸ªå°æ—¶ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯ä¸€ç›´ä¸å¯ç”¨çš„ï¼Œè¿™æ ·è‚¯å®šä¸è¡Œã€‚</p><p>è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿå¾ˆç®€å•ï¼Œä½ ä¸è¦ç­‰ç€æ•°æ®åº“å®•æœºäº†ï¼Œæ‰å¼€å§‹åšæ¢å¤ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æå‰æ¥åšæ¢å¤è¿™äº›äº‹å„¿ã€‚</p><p>æˆ‘ä»¬å‡†å¤‡ä¸€å°å¤‡ç”¨çš„æ•°æ®åº“ï¼ŒæŠŠå®ƒçš„æ•°æ®æ¢å¤æˆä¸»åº“ä¸€æ ·ï¼Œç„¶åå®æ—¶åœ°åœ¨ä¸»å¤‡æ•°æ®åº“ä¹‹é—´æ¥åŒæ­¥Binlogï¼Œä¸»åº“åšäº†ä¸€æ¬¡æ•°æ®å˜æ›´ï¼Œç”Ÿæˆä¸€æ¡Binlogï¼Œæˆ‘ä»¬å°±æŠŠè¿™ä¸€æ¡Binlogå¤åˆ¶åˆ°å¤‡ç”¨åº“å¹¶ç«‹å³å›æ”¾ï¼Œè¿™æ ·å°±å¯ä»¥è®©å¤‡ç”¨åº“é‡Œé¢çš„æ•°æ®å’Œä¸»åº“ä¸­çš„æ•°æ®ä¸€ç›´ä¿æŒæ˜¯ä¸€æ ·çš„ã€‚ä¸€æ—¦ä¸»åº“å®•æœºï¼Œå°±å¯ä»¥ç«‹å³åˆ‡æ¢åˆ°å¤‡ç”¨åº“ä¸Šç»§ç»­æä¾›æœåŠ¡ã€‚è¿™å°±æ˜¯MySQLçš„é«˜å¯ç”¨æ–¹æ¡ˆï¼Œä¹Ÿå«MySQL HAã€‚</p><p>MySQLè‡ªèº«å°±æä¾›äº†ä¸»ä»å¤åˆ¶çš„åŠŸèƒ½ï¼Œé€šè¿‡é…ç½®å°±å¯ä»¥è®©ä¸€ä¸»ä¸€å¤‡ä¸¤å°MySQLçš„æ•°æ®åº“ä¿æŒæ•°æ®åŒæ­¥ï¼Œå…·ä½“çš„é…ç½®æ–¹æ³•ä½ å¯ä»¥å‚è€ƒ<a href="https://dev.mysql.com/doc/refman/8.0/en/replication.html">MySQå®˜æ–¹æ–‡æ¡£ä¸­â€œå¤åˆ¶â€è¿™ä¸€ç« </a>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯´è¿™ä¸ªæ–¹æ¡ˆçš„é—®é¢˜ã€‚å½“æˆ‘ä»¬å¯¹ä¸»åº“æ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œçš„æ—¶å€™ï¼Œä¸»ä»ä¸¤ä¸ªæ•°æ®åº“æ›´æ–°æ•°æ®å®é™…çš„æ—¶åºæ˜¯è¿™æ ·çš„ï¼š</p><ol>
<li>åœ¨ä¸»åº“çš„ç£ç›˜ä¸Šå†™å…¥Binlogï¼›</li>
<li>ä¸»åº“æ›´æ–°å­˜å‚¨å¼•æ“ä¸­çš„æ•°æ®ï¼›</li>
<li>ç»™å®¢æˆ·ç«¯è¿”å›æˆåŠŸå“åº”ï¼›</li>
<li>ä¸»åº“æŠŠBinlogå¤åˆ¶åˆ°ä»åº“ï¼›</li>
<li>ä»åº“å›æ”¾Binlogï¼Œæ›´æ–°å­˜å‚¨å¼•æ“ä¸­çš„æ•°æ®ã€‚</li>
</ol><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä»åº“çš„æ•°æ®æ˜¯æœ‰å¯èƒ½æ¯”ä¸»åº“ä¸Šçš„æ•°æ®æ—§ä¸€äº›çš„ï¼Œè¿™ä¸ªä¸»ä»ä¹‹é—´å¤åˆ¶æ•°æ®çš„å»¶è¿Ÿï¼Œç§°ä¸ºâ€œä¸»ä»å»¶è¿Ÿâ€ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸»ä»å»¶è¿ŸåŸºæœ¬éƒ½æ˜¯æ¯«ç§’çº§åˆ«ï¼Œä½ å¯ä»¥è®¤ä¸ºä¸»ä»å°±æ˜¯å®æ—¶ä¿æŒåŒæ­¥çš„ã€‚éº»çƒ¦çš„æ˜¯ä¸æ­£å¸¸çš„æƒ…å†µï¼Œä¸€æ—¦ä¸»åº“æˆ–è€…ä»åº“ç¹å¿™çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°æ˜æ˜¾çš„ä¸»ä»å»¶è¿Ÿã€‚</p><p>è€Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ•°æ®åº“éƒ½ä¸æ˜¯çªç„¶å®•æœºçš„ï¼Œè€Œæ˜¯å…ˆç¹å¿™ï¼Œæ€§èƒ½ä¸‹é™ï¼Œæœ€ç»ˆå®•æœºã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆæœ‰å¯èƒ½ä¸»ä»å»¶è¿Ÿå¾ˆå¤§ï¼Œå¦‚æœæˆ‘ä»¬æŠŠä¸šåŠ¡ç›´æ¥åˆ‡åˆ°ä»åº“ä¸Šç»§ç»­è¯»å†™ï¼Œä¸»ä»å»¶è¿Ÿè¿™éƒ¨åˆ†æ•°æ®å°±ä¸¢äº†ï¼Œå¹¶ä¸”è¿™ä¸ªæ•°æ®ä¸¢å¤±æ˜¯ä¸å¯é€†çš„ã€‚å³ä½¿äº‹åä½ æ‰¾å›äº†å½“æ—¶ä¸»åº“çš„Binlogä¹Ÿæ˜¯æ²¡æ³•åšåˆ°è‡ªåŠ¨æ¢å¤çš„ï¼Œå› ä¸ºå®ƒå’Œä»åº“çš„æ•°æ®æ˜¯å†²çªçš„ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œå¦‚æœä¸»åº“å®•æœºå¹¶ä¸”ä¸»ä»å­˜åœ¨å»¶è¿Ÿçš„æƒ…å†µä¸‹ï¼Œåˆ‡æ¢åˆ°ä»åº“ç»§ç»­è¯»å†™ï¼Œå¯ä»¥ä¿è¯ä¸šåŠ¡çš„å¯ç”¨æ€§ï¼Œä½†æ˜¯ä¸»ä»å»¶è¿Ÿè¿™éƒ¨åˆ†æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p><p>è¿™ä¸ªæ—¶å€™ä½ å°±éœ€è¦åšä¸€ä¸ªé€‰æ‹©é¢˜äº†ï¼Œç¬¬ä¸€ä¸ªé€‰é¡¹æ˜¯ï¼Œä¿è¯ä¸ä¸¢æ•°æ®ï¼Œç‰ºç‰²å¯ç”¨æ€§ï¼Œæš‚æ—¶åœæ­¢æœåŠ¡ï¼Œæƒ³åŠæ³•æŠŠä¸»åº“çš„Binlogæ¢å¤åˆ°ä»åº“ä¸Šä¹‹åå†æä¾›æœåŠ¡ã€‚ç¬¬äºŒä¸ªé€‰é¡¹å°±æ˜¯ï¼Œå†’ç€ä¸¢ä¸€äº›æ•°æ®çš„é£é™©ï¼Œä¿è¯å¯ç”¨æ€§ï¼Œç¬¬ä¸€æ—¶é—´åˆ‡æ¢åˆ°ä»åº“ç»§ç»­æä¾›æœåŠ¡ã€‚</p><p>é‚£èƒ½ä¸èƒ½æ—¢ä¿è¯æ•°æ®ä¸ä¸¢ï¼Œè¿˜èƒ½åšåˆ°é«˜å¯ç”¨å‘¢ï¼Ÿä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œé‚£ä½ å°±è¦ç‰ºç‰²ä¸€äº›æ€§èƒ½ã€‚MySQLä¹Ÿæ”¯æŒ<a href="https://dev.mysql.com/doc/refman/8.0/en/replication-semisync.html">åŒæ­¥å¤åˆ¶</a>ï¼Œå¼€å¯åŒæ­¥å¤åˆ¶æ—¶ï¼ŒMySQLä¸»åº“ä¼šç­‰å¾…æ•°æ®æˆåŠŸå¤åˆ¶åˆ°ä»åº“ä¹‹åï¼Œå†ç»™å®¢æˆ·ç«¯è¿”å›å“åº”ã€‚</p><p>å¦‚æœè¯´ï¼Œç‰ºç‰²çš„è¿™ç‚¹å„¿æ€§èƒ½æˆ‘ä¸åœ¨ä¹ï¼Œè¿™ä¸ªæ–¹æ¡ˆæ˜¯ä¸æ˜¯å°±å®Œç¾äº†å‘¢ï¼Ÿä¹Ÿä¸æ˜¯ï¼Œæ–°çš„é—®é¢˜åˆæ¥äº†ï¼ä½ æƒ³ä¸€ä¸‹ï¼Œè¿™ç§æƒ…å†µä¸‹ä»åº“å®•æœºäº†æ€ä¹ˆåŠï¼Ÿæœ¬æ¥ä»åº“å®•æœºå¯¹ä¸»åº“æ˜¯å®Œå…¨æ²¡å½±å“çš„ï¼Œå› ä¸ºç°åœ¨ä¸»åº“è¦ç­‰å¾…ä»åº“å†™å…¥æˆåŠŸå†è¿”å›ï¼Œä»åº“å®•æœºï¼Œä¸»åº“å°±ä¼šä¸€ç›´ç­‰å¾…ä»åº“ï¼Œä¸»åº“ä¹Ÿå¡æ­»äº†ã€‚</p><p>è¿™ä¸ªé—®é¢˜ä¹Ÿæœ‰è§£å†³åŠæ³•ï¼Œé‚£å°±æ˜¯å†åŠ ä¸€ä¸ªä»åº“ï¼ŒæŠŠä¸»åº“é…ç½®æˆï¼šæˆåŠŸå¤åˆ¶åˆ°ä»»æ„ä¸€ä¸ªä»åº“å°±è¿”å›ï¼Œåªè¦æœ‰ä¸€ä¸ªä»åº“è¿˜æ´»ç€ï¼Œå°±ä¸ä¼šå½±å“ä¸»åº“å†™å…¥æ•°æ®ï¼Œè¿™æ ·å°±è§£å†³äº†ä»åº“å®•æœºé˜»å¡ä¸»åº“çš„é—®é¢˜ã€‚å¦‚æœä¸»åº“å‘ç”Ÿå®•æœºï¼Œåœ¨ä¸¤ä¸ªä»åº“ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªä»åº“ä¸­çš„æ•°æ®æ˜¯å’Œä¸»åº“å®Œå…¨ä¸€æ ·çš„ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåº“ä½œä¸ºæ–°çš„ä¸»åº“ï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚ä¸ºæ­¤ä½ éœ€è¦ä»˜å‡ºçš„ä»£ä»·æ˜¯ï¼Œä½ è¦è‡³å°‘ç”¨ä¸‰å°æ•°æ®åº“æœåŠ¡å™¨ï¼Œå¹¶ä¸”è¿™ä¸‰å°æœåŠ¡å™¨æä¾›çš„æœåŠ¡æ€§èƒ½ï¼Œè¿˜ä¸å¦‚ä¸€å°æœåŠ¡å™¨é«˜ã€‚</p><p>æˆ‘æŠŠä¸Šé¢è¿™ä¸‰ç§å…¸å‹çš„HAæ–¹æ¡ˆæ€»ç»“æˆä¸‹é¢è¿™ä¸ªè¡¨æ ¼ï¼Œä¾¿äºä½ å¯¹æ¯”é€‰æ‹©ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/04/ac/04ff6bce8f5b607950fc469a606433ac.jpg" alt=""></p><h2>å°ç»“</h2><p>ä»Šå¤©è¿™èŠ‚è¯¾è®²äº†ä¸¤ä»¶äº‹å„¿ï¼Œä¸€æ˜¯å¦‚ä½•å¤‡ä»½å’Œæ¢å¤æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ï¼›äºŒæ˜¯å¦‚ä½•æ¥å®ç°æ•°æ®åº“çš„é«˜å¯ç”¨ï¼Œé¿å…å®•æœºåœæœã€‚</p><p>è™½ç„¶è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„é—®é¢˜ï¼Œä½†ä½ è¦çŸ¥é“ï¼Œè§£å†³è¿™ä¸¤ä¸ªé—®é¢˜èƒŒåçš„å®ç°åŸç†æ˜¯ä¸€æ ·çš„ã€‚<strong>é«˜å¯ç”¨ä¾èµ–çš„æ˜¯æ•°æ®å¤åˆ¶ï¼Œæ•°æ®å¤åˆ¶çš„æœ¬è´¨å°±æ˜¯ä»ä¸€ä¸ªåº“å¤‡ä»½æ•°æ®ï¼Œç„¶åæ¢å¤åˆ°å¦å¤–ä¸€ä¸ªåº“ä¸­å»ã€‚</strong></p><p>æ•°æ®å¤‡ä»½æ—¶ï¼Œä½¿ç”¨ä½é¢‘åº¦çš„å…¨é‡å¤‡ä»½é…åˆBinlogå¢é‡å¤‡ä»½æ˜¯ä¸€ç§å¸¸ç”¨è€Œä¸”éå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œä½¿ç”¨è¿™ç§å¤‡ä»½æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°æ®åº“çš„æ•°æ®ç²¾ç¡®åœ°æ¢å¤åˆ°å†å²ä¸Šä»»æ„ä¸€ä¸ªæ—¶åˆ»ï¼Œä¸ä»…èƒ½è§£å†³æ•°æ®æŸåçš„é—®é¢˜ï¼Œä¹Ÿä¸ç”¨æ€•è¯¯æ“ä½œã€åˆ åº“è·‘è·¯è¿™äº›äº‹å„¿äº†ã€‚ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œè®©å¤‡ä»½æ•°æ®å°½é‡åœ°è¿œç¦»æ•°æ®åº“ã€‚</p><p>æˆ‘ä»¬ä»Šå¤©è®²åˆ°çš„å‡ ç§MySQLå…¸å‹çš„HAæ–¹æ¡ˆï¼Œåœ¨æ•°æ®å¯é æ€§ã€æ•°æ®åº“å¯ç”¨æ€§ã€æ€§èƒ½å’Œæˆæœ¬å‡ ä¸ªæ–¹é¢ï¼Œå„æœ‰åˆ©å¼Šï¼Œä½ éœ€è¦æ ¹æ®ä¸šåŠ¡æƒ…å†µï¼Œåšä¸€ä¸ªæœ€ä¼˜çš„é€‰æ‹©ï¼Œå¹¶ä¸”ä¸ºå¯èƒ½å­˜åœ¨çš„é£é™©åšå¥½å‡†å¤‡ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯¾åä¹Ÿè¯·ä½ åœ¨ç•™è¨€åŒºåˆ†äº«ä¸€ä¸‹ï¼Œä½ ç°åœ¨è´Ÿè´£ç³»ç»Ÿçš„æ•°æ®åº“æ˜¯å¦‚ä½•æ¥å®ç°é«˜å¯ç”¨çš„ï¼Œæœ‰ä»€ä¹ˆé£é™©å’Œé—®é¢˜ï¼Œå­¦ä¹ äº†è¿™èŠ‚è¯¾ä¹‹åï¼Œä½ ä¼šå¦‚ä½•æ¥æ”¹è¿›è¿™ä¸ªé«˜å¯ç”¨æ–¹æ¡ˆï¼Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘è®¨è®ºã€‚</p><p>æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æç¥  2020-03-12 16:25:08
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            Hiï¼Œæˆ‘æ˜¯æç¥ã€‚<br><br>ç…§ä¾‹è¯´ä¸€ä¸‹ä¸ŠèŠ‚è¯¾æ€è€ƒé¢˜ï¼š<br><br>æˆ‘ä»¬åœ¨ç”µå•†çš„æœç´¢æ¡†ä¸­æœç´¢å•†å“æ—¶ï¼Œå®ƒéƒ½æœ‰ä¸€ä¸ªæœç´¢æç¤ºçš„åŠŸèƒ½ï¼Œæ¯”å¦‚æˆ‘è¾“å…¥â€œè‹¹æœâ€è¿˜æ²¡æœ‰ç‚¹å‡»æœç´¢æŒ‰é’®çš„æ—¶å€™ï¼Œæœç´¢æ¡†ä¸‹é¢ä¼šæç¤ºâ€œè‹¹æœæ‰‹æœºâ€ã€â€œè‹¹æœ11ã€è‹¹æœç”µè„‘â€è¿™äº›å»ºè®®çš„æœç´¢å…³é”®å­—ï¼Œè¯·ä½ è¯¾åçœ‹ä¸€ä¸‹ESçš„æ–‡æ¡£ï¼Œæƒ³ä¸€ä¸‹ï¼Œå¦‚ä½•ç”¨ESå¿«é€Ÿåœ°å®ç°è¿™ä¸ªæœç´¢æç¤ºåŠŸèƒ½ï¼Ÿ<br><br>åœ¨è¯¾åç•™è¨€ä¸­ï¼ŒGeek_c76e2dåŒå­¦ç»™å‡ºçš„ç­”æ¡ˆéå¸¸èµï¼Œæˆ‘åœ¨è¿™é‡Œå°±ç›´æ¥â€œç›—ç”¨â€äº†ï¼Œä»¥ä¸‹æ˜¯Geek_c76e2dåŒå­¦çš„ç­”æ¡ˆï¼š<br><br>å› ä¸ºç”¨æˆ·æ¯è¾“å…¥ä¸€ä¸ªå­—éƒ½å¯èƒ½ä¼šå‘è¯·æ±‚æŸ¥è¯¢æœç´¢æ¡†ä¸­çš„æœç´¢æ¨èã€‚æ‰€ä»¥æœç´¢æ¨èçš„è¯·æ±‚é‡è¿œé«˜äºæœç´¢æ¡†ä¸­çš„æœç´¢ã€‚esé’ˆå¯¹è¿™ç§æƒ…å†µæä¾›äº†suggestion apiï¼Œå¹¶æä¾›çš„ä¸“é—¨çš„æ•°æ®ç»“æ„åº”å¯¹æœç´¢æ¨èï¼Œæ€§èƒ½é«˜äºmatchï¼Œä½†å®ƒåº”ç”¨èµ·æ¥ä¹Ÿæœ‰å±€é™æ€§ï¼Œå°±æ˜¯åªèƒ½åšå‰ç¼€åŒ¹é…ã€‚å†ç»“åˆpinyinåˆ†è¯å™¨å¯ä»¥åšåˆ°è¾“å…¥æ‹¼éŸ³å­—æ¯å°±æç¤ºä¸­æ–‡ã€‚å¦‚æœæƒ³åšéå‰ç¼€åŒ¹é…ï¼Œå¯ä»¥è€ƒè™‘Ngramã€‚ä¸è¿‡Ngramæœ‰äº›å¤æ‚ï¼Œéœ€è¦å¼€å‘è€…è‡ªå®šä¹‰åˆ†æå™¨ã€‚æ¯”å¦‚æœ‰ä¸ªç½‘å€www.geekbang.comï¼Œç”¨æˆ·å¯èƒ½è®°ä¸æ¸…å…·ä½“ç½‘å€äº†ï¼Œåªè®°å¾—ç½‘å€ä¸­æœ‰2ä¸ªeï¼Œæ­¤æ—¶ç”¨æˆ·è¾“å…¥eeä¸¤ä¸ªå­—æ¯ä¹Ÿæ˜¯å¯ä»¥åœ¨æœç´¢æ¡†æç¤ºå‡ºè¿™ä¸ªç½‘å€çš„ã€‚ä»¥ä¸Šæ˜¯æˆ‘åœ¨å·¥ä½œä¸­é’ˆå¯¹å‰ç¼€æœç´¢æ¨èå’Œéå‰ç¼€æœç´¢æ¨èçš„å®ç°æ–¹æ¡ˆã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            skyline  2020-03-12 01:04:13
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            é™¤äº†æŠ€æœ¯æ–¹é¢ï¼Œæˆ‘è§‰å¾—åˆ åº“è·‘è·¯ä¹Ÿæ˜¯ä¸€ä¸ªç®¡ç†æœºåˆ¶ä¸Šçš„é—®é¢˜ï¼Œè¦å½“æˆä¸å¯æŠ—å› ç´ å»å¯¹å¾…ã€‚<br><br>ä¸ºé˜²æ­¢åœ°éœ‡æˆ‘ä»¬éœ€è¦å¼‚åœ°å¤‡ä»½ï¼Œè·ç¦»è¶Šè¿œè¶Šå¥½ï¼Œä¸ºé˜²æ­¢è·‘è·¯æˆ‘ä»¬éœ€è¦å®Œå–„çš„æƒé™ç®¡ç†ã€‚<br><br>ä¸èƒ½è®©ä¸€ä¸ªäººæœ‰èƒ½æ¥è§¦åˆ°æ‰€æœ‰å¤‡ä»½çš„æƒé™ï¼Œå¦åˆ™å°±è·Ÿå•æœºæ•…éšœä¸€æ ·å‡ºç°&quot;å•äººæ•…éšœ&quot;ğŸ¤” [3èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æ»´æµä¹±è½¬å°èƒ–å­  2020-03-12 08:53:43
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è€å¸ˆå¥½ï¼Œå¼€ç¯‡çš„æŸäº‘åœºæ™¯å™è¿°ï¼Œå¥½çš®å•Šï¼ä¼˜ç§€ï¼ [1èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            qbit  2020-03-12 15:00:45
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            SHOW VARIABLES LIKE &#39;%log_bin%&#39;;<br>---<br>&quot;log_bin&quot;  &quot;OFF&quot;<br>&quot;log_bin_basename&quot;  &quot;&quot;<br>&quot;log_bin_index&quot;  &quot;&quot;<br>&quot;log_bin_trust_function_creators&quot;  &quot;OFF&quot;<br>&quot;sql_log_bin&quot;  &quot;ON&quot;<br>---<br>è¯·é—® sql_log_bin å’Œ log_bin æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            qbit  2020-03-12 14:05:40
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è…¾è®¯äº‘æ˜¯ä¸€å®¶è‘—åçš„äº‘æœåŠ¡å•†:-D 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            åˆ˜æ¥   2020-03-12 09:05:39
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
             binlog æ—¥å¿—ä¸­ä¹Ÿæ˜¯æœ‰åˆ é™¤åº“çš„SQLçš„ï¼Œéš¾é“ï¼Œå¤‡åº“æˆ–è€…ä»åº“ä¸ä¼šæ‰§è¡Œå—ï¼Ÿæ„Ÿè§‰ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥æ•°æ®åœ¨å‡ ä¸ªåº“éƒ½åˆ é™¤äº†ã€‚æ€ä¹ˆä¿è¯å¤‡åº“æˆ–è€…ä»çš„æ•°æ®ï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å‘æ¡æ©™å­ ã€‚  2020-03-12 07:40:47
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è€å¸ˆ binlogä¸­ä¸ä¼šåŒ…å«åˆ é™¤è¡¨çš„é‚£è¡Œè®°å½•ä¹ˆ è¿˜æ˜¯è¯´è™½ç„¶åŒ…å« ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¸å»æ‰§è¡Œé‚£æ¡å‘½ä»¤ 
        </div>
        
    </div>
</li>
            </ul>
</div>
</body>
</html>